I've created this script to add to a database and compare results of vulnerability scans from a popular tool. Simply to keep the track of all scans and see scan-to-scan changes. Surprisingly, many popular tools, even corporate level ones, don't have this feature (sic!)

The backbone of this script is a TinyDB, so a non-relational database kept in json format. Small, portable, easy to use. At least for this purpose.


All you need to do is export the file from the vulnerability scanner in a below format:

    ip_address,port,protocol,service_name,service_version
    1.1.1.1,53,UDP,Unknown,Unknown

then you just:

    usage: r7db [-h] -i example_report_file.csv

First time you get:

    Initial import. I have nothing to compare it to.
    
When you add another scan, you get either:

    ======================================
     No changes comparing to the old scan 
    ======================================

or:

    IP PORT PROTOCOL
    
    DELETED:
    =====================================
    99.222.111.100 1935 TCP
    93.222.223.101 80 TCP

    NEW:
    =====================================
    99.222.111.1 443 TCP
    93.222.223.2 53 UDP


After the file has been added  to the db, the original report will be taken away, renamed with actual date and put in arch folder.

